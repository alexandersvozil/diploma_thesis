% Copyright (C) 2014-2015 by Thomas Auzinger <thomas@auzinger.name>
\documentclass[draft,final]{vutinfth} % Remove option 'final' to obtain debug information.

% Load packages to allow in- and output of non-ASCII characters.
\usepackage{lmodern}        % Use an extension of the original Computer Modern font to minimize the use of bitmapped letters.
\usepackage[T1]{fontenc}    % Determines font encoding of the output. Font packages have to be included before this line.
\usepackage[utf8]{inputenc} % Determines encoding of the input. All input files have to use UTF8 encoding.

% Extended LaTeX functionality is enables by including packages with \usepackage{...}.
\usepackage{listings}
\usepackage{fixltx2e}   % Provides fixes for several errors in LaTeX2e.
\usepackage{stmaryrd}
\usepackage{amsmath}    % Extended typesetting of mathematical expression.
\usepackage{amsthm}
\usepackage{amssymb}    % Provides a multitude of mathematical symbols.
\usepackage{mathtools}  % Further extensions of mathematical typesetting.
\usepackage{microtype}  % Small-scale typographic enhancements.
\usepackage{enumitem}   % User control over the layout of lists (itemize, enumerate, description).
\usepackage{multirow}   % Allows table elements to span several rows.
\usepackage{booktabs}   % Improves the typesettings of tables.
\usepackage{subcaption} % Allows the use of subfigures and enables their referencing.
\usepackage[ruled,linesnumbered,algochapter]{algorithm2e} % Enables the writing of pseudo code.
\usepackage[usenames,dvipsnames,table]{xcolor} % Allows the definition and use of colors. This package has to be included before tikz.
\usepackage{nag}       % Issues warnings when best practices in writing LaTeX documents are violated.
\usepackage{hyperref}  % Enables cross linking in the electronic document version. This package has to be included second to last.
\usepackage[acronym,toc]{glossaries} % Enables the generation of glossaries and lists fo acronyms. This package has to be included last.
\usepackage{tikz}

% Define convenience functions to use the author name and the thesis title in the PDF document properties.
\newcommand{\authorname}{Alexander Svozil} % The author name without titles.
\newcommand{\thesistitle}{Complexity of well-designed SPARQL} % The title of the thesis. The English version should be used, if it exists.

% Set PDF document properties
\hypersetup{
    pdfpagelayout   = TwoPageRight,           % How the document is shown in PDF viewers (optional).
    linkbordercolor = {Melon},                % The color of the borders of boxes around crosslinks (optional).
    pdfauthor       = {\authorname},          % The author's name in the document properties (optional).
    pdftitle        = {\thesistitle},         % The document's title in the document properties (optional).
    pdfsubject      = {Subject},              % The document's subject in the document properties (optional).
    pdfkeywords     = {a, list, of, keywords} % The document's keywords in the document properties (optional).
}
\lstset{
  basicstyle=\ttfamily,
  mathescape,
%  numbers=left,                   % where to put the line-numbers
  numberstyle=\footnotesize,      % the size of the fonts that are used for the
  stepnumber=1,                   % the step between two line-numbers. If it is
  numbersep=10pt,                  % how far the line-numbers are from the code
  escapeinside={(*@}{@*)},
 %numbers=left,               % Ort der Zeilennummern
  %numberstyle=\tiny,          % Stil der Zeilennummern
         %stepnumber=2,               % Abstand zwischen den Zeilennummern
     %    numbersep=5pt,              % Abstand der Nummern zum Text
    %     tabsize=2,                  % Groesse von Tabs
    %     extendedchars=true,         %
         breaklines=true,            % Zeilen werden Umgebrochen
    %     keywordstyle=\color{red},
    %        frame=b,         
 %        keywordstyle=[1]\textbf,    % Stil der Keywords
 %        keywordstyle=[2]\textbf,    %
 %        keywordstyle=[3]\textbf,    %
 %        keywordstyle=[4]\textbf,   \sqrt{\sqrt{}} %
    %     stringstyle=\color{white}\ttfamily, % Farbe der String
    %     showspaces=false,           % Leerzeichen anzeigen ?
    %     showtabs=false,             % Tabs anzeigen ?
		 %         xleftmargin=17pt,
         %framexleftmargin=17pt,
         %framexrightmargin=5pt,
         %framexbottommargin=4pt
         %backgroundcolor=\color{lightgray},
    %     showstringspaces=false      % Leerzeichen in Strings anzeigen ?        
}

\setsecnumdepth{subsection} % Enumerate subsections.

\nonzeroparskip             % Create space between paragraphs (optional).
\setlength{\parindent}{0pt} % Remove paragraph identation (optional).

\makeindex      % Use an optional index.
\makeglossaries % Use an optional glossary.
%\glstocfalse   % Remove the glossaries from the table of contents.

% Set persons with 4 arguments:
%  {title before name}{name}{title after name}{gender}
%  where both titles are optional (i.e. can be given as empty brackets {}).
\setauthor{}{\authorname}{Bsc.}{male}
\setadvisor{Univ.Prof. Mag.rer.nat. Dr.techn.}{Reinhard Pichler}{}{male}

% For bachelor and master theses:
%\setfirstassistant{Professor Dr.}{Reinhard Pichler}{}{male}
\setfirstassistant{Univ.Ass. Dipl.-Ing. Dr.techn.}{Sebastian Skritek}{}{male}
\setsecondassistant{Univ.Ass. Dipl.-Ing.}{Markus Kr√∂ll}{}{male}

% For dissertations:
\setfirstreviewer{Pretitle}{Forename Surname}{Posttitle}{male}
\setsecondreviewer{Pretitle}{Forename Surname}{Posttitle}{male}

% For dissertations at the PhD School:
\setsecondadvisor{Pretitle}{Forename Surname}{Posttitle}{male}

% Required data.
\setaddress{Wasnergasse 13/20, Wien 1200}
\setregnumber{1026213}
\setdate{27}{4}{2016}
\settitle{\thesistitle}{Complexity of well-designed SPARQL} % Sets English and German version of the title (both can be English or German).
%\setsubtitle{Optional Subtitle of the Thesis}{Optionaler Untertitel der Arbeit} % Sets English and German version of the subtitle (both can be English or German).

% Select the thesis type: bachelor / master / doctor / phd-school.
% Bachelor:
\setthesis{master}
%
% Master:
%\setthesis{master}
\setmasterdegree{dipl.} % dipl. / rer.nat. / rer.soc.oec. / master
%
% Doctor:
%\setthesis{doctor}
%\setdoctordegree{rer.soc.oec.}% rer.nat. / techn. / rer.soc.oec.
%
% Doctor at the PhD School
%\setthesis{phd-school} % Deactivate non-English title pages (see below)

% For bachelor and master:
\setcurriculum{Computational Intelligence}{Computational Intelligence} % Sets the English and German name of the curriculum.

% For dissertations at the PhD School:
\setfirstreviewerdata{Affiliation, Country}
\setsecondreviewerdata{Affiliation, Country}

% Define convenience macros.
\newcommand{\todo}[1]{{\color{red}\textbf{TODO: {#1}}}} % Comment for the final version, to raise errors.
\newcommand{\U}{\mathbf{U}}
\renewcommand{\u}{\mathcal{U}}
\newcommand{\vars}{\mathit{vars}}
\newcommand{\names}{\mathit{names}}
\newcommand{\graph}{\mathit{graph}}
\newcommand{\fvars}{\mathit{fvars}}
\newcommand{\evars}{\mathit{evars}}
\newcommand{\trans}{\mathit{trans}}
\newcommand{\DS}{\mathit{DS}}
\renewcommand{\l}{\mathcal{L}}
\newcommand{\s}{\mathcal{S}}
\newcommand{\V}{\mathbf{V}}
\newcommand{\OPT}{\mbox{ OPT } }
\newcommand{\UNION}{\mbox{ UNION } }
\newcommand{\GRAPH}{\mbox{ GRAPH } }
\newcommand{\SERVICE}{\mbox{ SERVICE } }
\newcommand{\AND}{\mbox{ AND }}
\newcommand{\FILTER}{\mbox{ FILTER }}
\newcommand{\SELECT}{\mbox{ SELECT }}
\newcommand{\WHERE}{\mbox{ WHERE }}
\renewcommand{\ll}{\llbracket}
\newcommand{\rr}{\rrbracket}
\newcommand{\T}{\mathcal{T}}
\newcommand{\Qo}{\llbracket Q_1 \rrbracket^{DS}_G}
\newcommand{\Qt}{\llbracket Q_2 \rrbracket^{DS}_G}
\renewcommand{\c} {\overrightarrow{c}}
\newtheorem{example}{Example}
\newtheorem{corollary}{Corollary}
\newtheorem{definition}{Definition}
\newtheorem{proposition}{Proposition}
\newtheorem{theorem}{Theorem}
\newenvironment{proofidea}{\noindent\textit{Proof Idea.}}{\hfill$\square$}
\newtheorem{lemma}{Lemma}

\begin{document}
\frontmatter % Switches to roman numbering.
% The structure of the thesis has to conform to
%  http://www.informatik.tuwien.ac.at/dekanat

\addtitlepage{naustrian} % German title page (not for dissertations at the PhD School).
\addtitlepage{english} % English title page.
\addstatementpage

\begin{acknowledgements*}
	First of all I want to thank my advisor, Prof. Dr. Reinhard Pichler not only
	for his guidance, support and patience but also for opening up this topic for me.
	I would also like to thank him for introducing me to his team at the
	database institute; in particular,  Dr. Sebastian Skritek and Dipl.-Ing. Markus Kr{\"o}ll. I would like to
	thank them all for letting me participate in their discourse and their
	valuable input. In particular I would like to thank
	Dr. Sebastian Skritek as he spent a great amount of time discussing and
	improving the proofs in the thesis with me. 

	\noindent
	Last I would like to thank my family and my friends. 
	My parents Karl and Karin for not only making my academic studies possible but
	also for encouraging me to pursue my goals. I would like to especially thank my dad 
	for always sharing a cup of coffee with me when I needed it the most. 
	I would also like to thank my friends Mihail and Chris for making studying
	at the TU Wien one of the best experiences in my life. 
\end{acknowledgements*}

\begin{kurzfassung}
	SPARQL Protocol and RDF Query Language (SPARQL) ist eine standardisierte
	M{\"o}glichkeit	um Resource Description Framework (RDF) Daten aus dem
	Internet abzufragen. Ein Feature von SPARQL 1.0 ist der GRAPH Operator, der
	es erlaubt, mehrere lokale RDF Graphen in einer einzigen SPARQL Query zu
	verwenden. Mit der Zeit tauchten immer mehr SPARQL Schnittstellen im
	Internet auf
	und um jene auch ansprechen zu k{\"o}nnen, wurde der SERVICE Operator in der
	SPARQL 1.1 Federated Query extension eingef{\"u}hrt. Mit dem SERVICE Operator
	kann man, {\"a}hnlich dem GRAPH Operator, mehrere SPARQL Endpoints in einer
	Query ben{\"u}tzen. Sowohl der GRAPH Operator als auch der SERVICE Operator werfen
	neue
	Probleme in der Komplexit{\"a}tsanalyse von SPARQL auf. Die beiden
	Operatoren wurden bis jetzt noch nicht analysiert. Weil die Evaluierung von
	allgemeinen SPARQL Queries PSPACE-complete ist, beschr{\"a}nken wir unsere
	Beobachtungen auf well-designed SPARQL, wo das Evaluierungsproblem 
	coNP-complete ist. Wenn man das well-designed SPARQL Fragment mit SERVICE
	und GRAPH erweitert, erh{\"a}lt man ein neues SPARQL Fragment welches eine
	gute Basis f{\"u}r unsere Komplexit{\"a}tsanalyse darstellt. Wenn man
	allgemeines SPARQL um die beiden Operatoren erweitern w{\"u}rde, 
	k{\"o}nnte es sein, dass die Komplexit{\"a}t 
	der beiden Operatoren von diesem Fragment
	{\"u}berschattet w{\"u}rden. Wir werden zeigen, dass die 
	Komplexit{\"a}t des Evaluierungsproblems im
	well-designed Fragment, welches mit den Operatoren GRAPH und SERVICE
	erweitert wurde, coNP-complete ist. Wenn man den SERVICE operator in der
	Praxis benutzt, l{\"o}st dieser neue Schwierigkeiten aus, die mit der Einf{\"u}hrung
	mehrerer Notationen gel{\"o}st wurden. Der Unterschied dieser Notationen wurde
	bis jetzt noch nicht wirklich erforscht. Nachdem wir die Notationen
	eingef{\"u}hrt haben, werden wir sie diskutieren. 
	Wir werden auch das Fragment weakly well-designed SPARQL behandeln.
	Es ist ein auf well-designed SPARQL basierendes
	Fragment, welches allerdings m{\"a}chtiger ist, weil es einige Bedingungen des
	well-designed SPARQL Fragments schw{\"a}cht. 
\end{kurzfassung}

\begin{abstract}
	The SPARQL Protocol and RDF Query Language (SPARQL) presents a standardized way to
	query the growing amount of Resource Description Framework (RDF) data on the
	internet. A feature of SPARQL 1.0 is the GRAPH operator which is able to 
	query multiple local RDF graphs in only a single query. To access the growing
	amounts of SPARQL endpoints available on the internet, the SERVICE operator
	was introduced in the SPARQL 1.1 Federated Query extension.
	The SERVICE operator is used to query several
	SPARQL endpoints in only a single query, similar to the GRAPH operator.  
	Both the SERVICE and the GRAPH operator pose new problems in the 
	complexity analysis of SPARQL, as the two operators have not yet been analyzed.
	Because the evaluation of general SPARQL patterns is
	PSPACE-complete we restrict our considerations to well-designed SPARQL, where the
	evaluation problem is coNP-complete.
	Extending the well-designed fragment of SPARQL with the SERVICE and
	GRAPH operators yields a new SPARQL fragment
	which is a good basis for a complexity analysis, as general SPARQL
	would cloud the complexity of the SERVICE and GRAPH operators. 
	It is shown that the evaluation problem in this fragment is
	coNP-complete. Using the SERVICE operator in practice elicits difficulties which
	were resolved by introducing various notions. The subtle difference between
	those notions has not yet been fully explored.
	After defining the notions the differences between them will be discussed. 
	Building upon well-designed SPARQL we will
	also cover weakly well-designed SPARQL which renders a powerful
	fragment by relaxing constraints of well-designed SPARQL.
%	SPARQL has a special 
%	toolkit fitting the needs of querying RDF data in the semantic web. This toolkit is
%	powerful and needs to be analyzed complexity wise not only because the
%	associated mathematical proofs are interesting but also to optimize query
%	evaluation and to check if the
%	tools SPARQL provides are feasible for its practical use; that is, querying RDF data.
	%\noindent
	%A fragment of SPARQL which is convenient for complexity analysis called
	%well-designed SPARQL is introduced. Well-designed SPARQL will be enhanced with the
	%GRAPH and SERVICE operators which are used to query several databases from the
	%web in only a single query. The difficulties the SERVICE operator elicits in practice 
	%are adressed and discussed. 
	
%	\noindent Sometimes well-designed SPARQL is too
%	restrictive for practical use, and can be extended to weakly well-designed
%	SPARQL without aggravating the complexity of well-designed SPARQL. 
%	By relaxing constraints of well-designed SPARQL, weakly well-designed SPARQL 
%	renders a powerful fragment of SPARQL which comprises nearly all of the SPARQL
%	queries used in common practical setups.
\end{abstract}

% Select the language of the thesis, e.g., english or naustrian.
\selectlanguage{english}

% Add a table of contents (toc).
\tableofcontents % Starred version, i.e., \tableofcontents*, removes the self-entry.

% Switch to arabic numbering and start the enumeration of chapters in the table of content.
\mainmatter

\chapter{Introduction}
\input{introduction.tex}

\chapter{Preliminaries}
\input{definitions.tex}

\chapter{Well-Designed SPARQL}
\input{pods2014containment.tex}

\chapter{Complexity of well-designed SPARQL with GRAPH and SERVICE}
\input{serviceproof.tex}

\chapter{The SERVICE-operator in Practice}\label{chapter:serviceeval}
\input{builaranda.tex}

\chapter{Beyond well-designed SPARQL}
\input{beyondwelldesigned.tex}

\chapter{Conclusion}
In this thesis we presented an extension of the work of Perez et
al.~\cite{perez2009semantics}: In~\cite{perez2009semantics} well-designed SPARQL
was analyzed and we
extended the well-designed fragment with two SPARQL operators, namely GRAPH and SERVICE.
We then analyzed the evaluation problem of this fragment. This was done by
transforming well-designed patterns with GRAPH and SERVICE to a well-designed
pattern tree for which the complexity of the evaluation problem is well
known. Our results showed
that the complexity of the evaluation problem did not increase even though we
added the GRAPH and SERVICE operator to the well-designed SPARQL fragment.

We also investigated the difference between boundedness and strong boundedness,
two notions which were introduced by~\cite{BuilAranda20131}  
to evaluate SERVICE queries which gather information from several endpoints at
once. In~\cite{BuilAranda20131} we learned that deciding if a variable is
bounded in a graph pattern is undecidable and that deciding if a variable in a graph
pattern is strongly bounded is easily decidable. After comparing the two
definitions we found an example of a pattern where a variable was bound but not
strongly bound. We also conjectured that deciding if a variable is bound in
pattern might be decidable in fragments of SPARQL where the problem 
$\textbf{EQUIVALENCE}$ is feasible.

\section{Future Work}
There is still work to do on the theoretical side:
Most importantly we did not do a static analysis of the well-designed fragment of SPARQL
which allows the usage of the GRAPH and SERVICE operator. The problems \textbf{CONTAINMENT},
\textbf{SUBSUMPTION} and \textbf{EQUIVALENCE} still need to be analyzed in this
fragment. One could use our translation described in Section 4.1 as a foundation
for this work, even though one would likely need to modify it for this purpose.

The results for our fragment
$P_{wdgs}$ can be extended to weakly well-designed SPARQL. As 99\% of all queries containing OPT
are covered by the weakly-well designed SPARQL fragment we shall
have this fragment also support the GRAPH and SERVICE operators. 

When evaluating the SERVICE operator with a variable as destination,
semantics and algorithms for evaluation are still needed. There are more
problems than just binding the destination variables: The limited bandwidth of the
servers hosting RDF data demands specialized semantics and algorithms. Another
situation where adapted algorithms are needed is when RDF data is distributed
among several servers.

The conjecture that deciding if a variable is bound is decidable
in fragments of SPARQL where the problem $\textbf{EQUIVALENCE}$ is feasible
needs to be proven. This could be achieved by proving the correctness of
Algorithm~\ref{bsbalgorithm}.



\backmatter

% Use an optional list of figures.
\listoffigures % Starred version, i.e., \listoffigures*, removes the toc entry.

% Use an optional list of tables.
\listoftables % Starred version, i.e., \listoftables*, removes the toc entry.

% Use an optional list of alogrithms.
\listofalgorithms
\addcontentsline{toc}{chapter}{List of Algorithms}


% Add an index.
\printindex

% Add a glossary.
\printglossaries

% Add a bibliography.
\bibliographystyle{alpha}
\bibliography{intro}

\chapter{Appendix}
\input{appendix.tex}

\end{document}
